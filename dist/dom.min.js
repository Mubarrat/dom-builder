/*!
 * Dom-Builder JavaScript Library v1.0.0
 * https://github.com/Mubarrat/dom-builder/
 * 
 * Released under the MIT license
 * https://github.com/Mubarrat/dom-builder/blob/main/LICENSE
 */
function observable(e=null){let t=e;const n=new Set,o=new Set;function r(e){return 0!==arguments.length&&t!==e&&(t=e,r.notify()),t}return r.notify=()=>(n.forEach(e=>e(t)),o.forEach(e=>e.value=t)),r.subscribe=e=>(n.add(e),()=>n.delete(e)),r.bind=()=>({value:r(),refMVVM(){r.elements.add(this)}}),r.bindToSource=(e="oninput")=>({value:r(),[e](){r(this.value)}}),r.bindTwoWay=(e="oninput")=>({value:r(),[e](){r(this.value)},refMVVM(){r.elements.add(this)}}),r}function validatable(e=()=>!0,t=null){const n=observable(t);return n.isValid=(()=>e(n())).computed(n),n}Function.prototype.computed=function(...e){let t=this();const n=new Set,o=new Set;function r(){return t}return r.notify=()=>(n.forEach(e=>e(t)),o.forEach(e=>e.value=t)),r.subscribe=e=>(n.add(e),()=>n.delete(e)),r.bind=()=>({value:r(),refMVVM(){r.elements.add(this)}}),e.forEach(e=>e.subscribe(()=>{t=this(),r.notify()})),r},Object.defineProperties(Document.prototype,{$dom:{value(e){return new Proxy({},{get:(t,n)=>{const o=n.replace(/([A-Z])/g,"-$1").toLowerCase();return(...t)=>{const n=this.createElementNS(e,o);for(const e of t.flat(1/0))if(null!=e&&!1!==e)if(e.constructor===Object)for(const[t,o]of Object.entries(e))if("class"===t)n.className=o;else if("style"===t&&"object"==typeof o)Object.assign(n.style,o);else if("on"===t&&"object"==typeof o)for(const[e,t]of Object.entries(o))for(const o of[t].flat(1/0))"function"==typeof o&&n.addEventListener(e.toLowerCase(),o);else if(t.startsWith("on"))for(const e of[o].flat(1/0))"function"==typeof e&&n.addEventListener(t.slice(2).toLowerCase(),e);else if("data"===t&&"object"==typeof o)for(const e in o){const t=o[e];n.setAttribute(`data-${e}`,"object"==typeof t?JSON.stringify(t):t)}else if(t.toLowerCase().startsWith("ref"))for(const e of[o].flat(1/0))"function"==typeof e&&e.bind(n,n);else null!=o&&!1!==o&&n.setAttribute(t,"object"==typeof o?JSON.stringify(o):o);else{const t=[e];for(;t.length;){let e=t.pop();if(null!=e&&!1!==e){for(;"function"==typeof e;)e=e();Array.isArray(e)?t.push(...e.reverse()):e instanceof Node?n.append(e):n.append(this.createTextNode(String(e)))}}}return n}}})},configurable:!1,enumerable:!0},$html:{get(){return this.$html=this.$dom("http://www.w3.org/1999/xhtml")},configurable:!1,enumerable:!0},$svg:{get(){return this.$svg=this.$dom("http://www.w3.org/2000/svg")},configurable:!1,enumerable:!0},$mml:{get(){return this.$mml=this.$dom("http://www.w3.org/1998/Math/MathML")},configurable:!1,enumerable:!0}}),Function.prototype.recreate=function(...e){const t=this;let n=[t(o)].flat(1/0);function o(){const e=[t(o)].flat(1/0);n[0]&&(n[0].before(...e),n.forEach(e=>e.remove()),n=e,n.update=o)}return e.flat(1/0).forEach(e=>e.subscribe(o)),n.update=o,n},Function.prototype.reupdate=function(...e){const t=this;let n=t(c);function o(e,t){if(!e||!t)return!1;if(e.nodeType!==t.nodeType)return!1;if(3===e.nodeType)// Text node
return e.textContent===t.textContent;if(e.tagName!==t.tagName)return!1;if((e.id||void 0)!==(t.id||void 0))return!1;return(e.getAttribute("name")||void 0)===(t.getAttribute("name")||void 0)}function r(e,t){const n=e.attributes,o=t.attributes;for(let o=n.length-1;o>=0;o--){const r=n[o];t.hasAttribute(r.name)||e.removeAttribute(r.name)}for(let t=0;t<o.length;t++){const n=o[t];e.getAttribute(n.name)!==n.value&&e.setAttribute(n.name,n.value)}(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement||e instanceof HTMLSelectElement)&&("value"in e&&e.value!==t.value&&(e.value=t.value),"checked"in e&&e.checked!==t.checked&&(e.checked=t.checked),"selected"in e&&e.selected!==t.selected&&(e.selected=t.selected))}function i(e,t,n){t=Array.from(t),n=Array.from(n);const c=t.map(e=>({node:e,checked:!1}));let s=null;for(const t of n){let n=c.find(({node:e,checked:n})=>!n&&o(e,t));n?(n.checked=!0,s=n.node,1===n.node.nodeType?(r(n.node,t),i(n.node,n.node.childNodes,t.childNodes)):3===n.node.nodeType&&n.node.textContent!==t.textContent&&(n.node.textContent=t.textContent)):(s?s.after(t):e.prepend(t),s=t)}for(const{node:e,checked:t}of c)t||e.remove()}function c(){const e=t(c),s=(Array.isArray(n)?n[0]?.ownerDocument:n?.ownerDocument)||document;if(Array.isArray(n)&&Array.isArray(e)){const t=n[0]?.parentNode;if(!t)return;i(t,n,e)}else if(Array.isArray(n)||Array.isArray(e)){if(Array.isArray(n)){const t=n[0]?.parentNode;if(!t)return;const o=s.createComment("");t.insertBefore(o,n[0]),n.flat(1/0).forEach(e=>t.removeChild(e)),e.flat(1/0).forEach(e=>t.insertBefore(e,o)),t.removeChild(o)}else{const t=n.parentNode;if(!t)return;t.replaceChild(e,n)}n=e}else{const t=n.parentNode;if(!t)return;o(n,e)?(r(n,e),i(t,n.childNodes,e.childNodes)):(t.replaceChild(e,n),n=e)}n.update=c}return e.flat(1/0).forEach(e=>e.subscribe(c)),n.update=c,n},Object.defineProperties(Window.prototype,{$dom:{get(){return this.document.$dom},configurable:!1,enumerable:!0},$html:{get(){return this.document.$html},configurable:!1,enumerable:!0},$svg:{get(){return this.document.$svg},configurable:!1,enumerable:!0},$mml:{get(){return this.document.$mml},configurable:!1,enumerable:!0}});
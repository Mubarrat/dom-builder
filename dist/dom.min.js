/*!
 * Dom-Builder JavaScript Library v3.0.6
 * https://github.com/Mubarrat/dom-builder/
 * 
 * Released under the MIT license
 * https://github.com/Mubarrat/dom-builder/blob/main/LICENSE
 */
function base_observable(e,t){return e.subscribe=e=>(t.add(e),()=>t.delete(e)),e.notify=()=>t.forEach(t=>t(e())),e.bind=()=>({[Symbol.observable]:"one-way",target:e}),e.bindSelect=t=>(()=>t(e())).computed(e).bind(),e.bindMap=t=>e.bindSelect(e=>{if(null==e||"function"!=typeof e[Symbol.iterator])throw new Error("bindMap requires an iterable (Array, Set, Generator, etc.)");const r=[];let a=0;for(const o of e)r.push(t(o,a++));return r}),e}function observable(e=null){let t=e;const r=base_observable(function(e){return 0!==arguments.length&&t!==e&&(t=e,r.notify()),t},new Set);return r.bindToSource=()=>({[Symbol.observable]:"to-source",target:r}),r.bindTwoWay=()=>({[Symbol.observable]:"two-way",target:r}),r}function validatable(e=()=>!0,t=null){const r=observable(t);return r.isValid=(()=>e(r())).computed(r),r}Symbol.observable=Symbol("observable"),Array.prototype.bindSelect=function(e){return(()=>e(...this.map(e=>e()))).computed(...this).bind()},Function.prototype.computed=function(...e){const t=base_observable(this,new Set);return e.forEach(e=>e.subscribe(t.notify)),t},Object.defineProperties(Document.prototype,{$dom:{value(e){return new Proxy({},{get:(t,r)=>{const a=r.replace(/([A-Z])/g,"-$1").toLowerCase();return(...t)=>{const r=this.createElementNS(e,a);for(const e of o(t))if(null!=e&&!1!==e)if(e.constructor===Object&&void 0===e[Symbol.observable]&&void 0===e[Symbol.iterator]){for(const[t,a]of Object.entries(e))if("style"===t){if(a?.[Symbol.observable]){const e=a[Symbol.observable],t=a.target();if("string"==typeof t){const o=e=>r.setAttribute("style",e);switch(e){case"one-way":o(t),a.target.subscribe(o);break;case"to-source":o(t),new MutationObserver(()=>{a.target(r.getAttribute("style")||"")}).observe(r,{attributes:!0,attributeFilter:["style"]});break;case"two-way":o(t),a.target.subscribe(o),new MutationObserver(()=>{a.target(r.getAttribute("style")||"")}).observe(r,{attributes:!0,attributeFilter:["style"]});break;default:o(t)}return}const o=()=>{const e={};for(const t of r.style)e[t]=r.style[t];return e},s=e=>Object.assign(r.style,e);switch(e){case"one-way":s(t),a.target.subscribe(s);break;case"to-source":s(t),new MutationObserver(()=>{a.target(o())}).observe(r,{attributes:!0,attributeFilter:["style"]});break;case"two-way":s(t),a.target.subscribe(s),new MutationObserver(()=>{a.target(o())}).observe(r,{attributes:!0,attributeFilter:["style"]});break;default:s(t)}}else if("string"==typeof a)r.setAttribute("style",a);else if("object"==typeof a)for(const[e,t]of Object.entries(a))switch(t?.[Symbol.observable]){case"one-way":{const a=t=>r.style[e]=t;a(t.target()),t.target.subscribe(a);break}case"to-source":{const a=()=>r.style[e];t.target(a()),new MutationObserver(()=>{t.target(a())}).observe(r,{attributes:!0,attributeFilter:["style"]});break}case"two-way":{const a=()=>r.style[e],o=t=>r.style[e]=t;o(t.target()),t.target.subscribe(o),new MutationObserver(()=>{t.target(a())}).observe(r,{attributes:!0,attributeFilter:["style"]});break}default:r.style[e]=t}}else if("on"===t&&"object"==typeof a)for(const[e,t]of Object.entries(a))for(const a of o([t]))"function"==typeof a&&r.addEventListener(e.toLowerCase(),a);else if(t.startsWith("on"))for(const e of o([a]))"function"==typeof e&&r.addEventListener(t.slice(2).toLowerCase(),e);else if("data"===t&&"object"==typeof a)for(const e in a){const t=a[e],o=t=>r.dataset[e]="object"==typeof t?JSON.stringify(t):t;switch(t?.[Symbol.observable]){case"one-way":o(t.target()),t.target.subscribe(o);break;case"to-source":o(t.target()),new MutationObserver(()=>{const a=r.dataset[e];try{t.target(JSON.parse(a))}catch{t.target(a)}}).observe(r,{attributes:!0,attributeFilter:[`data-${e}`]});break;case"two-way":o(t.target()),t.target.subscribe(o),new MutationObserver(()=>{const a=r.dataset[e];try{t.target(JSON.parse(a))}catch{t.target(a)}}).observe(r,{attributes:!0,attributeFilter:[`data-${e}`]});break;default:o(t)}}else if(t.toLowerCase().startsWith("ref"))for(const e of o([a]))"function"==typeof e&&e.bind(r,r);else if("value"===t&&(r instanceof HTMLInputElement||r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement))switch(a?.[Symbol.observable]){case"one-way":r.value=a.target(),a.target.subscribe(e=>r.value=e);break;case"to-source":r.value=a.target(),r.addEventListener(r instanceof HTMLSelectElement?"change":"input",()=>a.target(r.value));break;case"two-way":r.value=a.target(),a.target.subscribe(e=>r.value=e),r.addEventListener(r instanceof HTMLSelectElement?"change":"input",()=>a.target(r.value));break;default:r.value=a}else if("checked"===t&&r instanceof HTMLInputElement&&("checkbox"===r.type||"radio"===r.type))switch(a?.[Symbol.observable]){case"one-way":r.checked=a.target(),a.target.subscribe(e=>r.checked=e);break;case"to-source":r.checked=a.target(),r.addEventListener("change",()=>a.target(r.checked));break;case"two-way":r.checked=a.target(),a.target.subscribe(e=>r.checked=e),r.addEventListener("change",()=>a.target(r.checked));break;default:r.checked=a}else if(void 0!==a){const e=e=>{t in r?r[t]=e:r.setAttribute(t,"object"==typeof e?JSON.stringify(e):e)};switch(a?.[Symbol.observable]){case"one-way":e(a.target()),a.target.subscribe(e);break;case"to-source":e(a.target()),new MutationObserver(()=>{let e=t in r?r[t]:r.getAttribute(t);try{a.target(JSON.parse(e))}catch{a.target(e)}}).observe(r,{attributes:!0,attributeFilter:[t],attributeOldValue:!0});break;case"two-way":e(a.target()),a.target.subscribe(e),new MutationObserver(()=>{let e=t in r?r[t]:r.getAttribute(t);try{a.target(JSON.parse(e))}catch{a.target(e)}}).observe(r,{attributes:!0,attributeFilter:[t],attributeOldValue:!0});break;default:e(a)}}}else if("one-way"===e?.[Symbol.observable]&&"function"==typeof e.target){const t=this.createTextNode("");r.append(t);let a=[];const o=()=>{for(const e of a)e.remove();a=[];let r=e.target();for(;"function"==typeof r;)r=r();const o=this.createDocumentFragment();for(const e of s([r])){if(null==e||!1===e)continue;const t=e instanceof Node?e:this.createTextNode(String(e));a.push(t),o.appendChild(t)}t.after(o)};o(),e.target.subscribe(o)}else for(const t of s([e]))null!=t&&!1!==t&&r.append(t instanceof Node?t:this.createTextNode(String(t)));return r;function o(e){return Array.from(e).flatMap(function e(t){return null==t||"string"==typeof t||t instanceof EventTarget||"function"!=typeof t[Symbol.iterator]?[t]:Array.from(t).flatMap(e)})}function s(e){return Array.from(e).flatMap(function e(t){for(;"function"==typeof t;)t=t();return null==t||"string"==typeof t||t instanceof EventTarget||"function"!=typeof t[Symbol.iterator]?[t]:Array.from(t).flatMap(e)})}}}})},configurable:!1,enumerable:!0},$html:{get(){return this.$html=this.$dom("http://www.w3.org/1999/xhtml")},configurable:!1,enumerable:!0},$svg:{get(){return this.$svg=this.$dom("http://www.w3.org/2000/svg")},configurable:!1,enumerable:!0},$mml:{get(){return this.$mml=this.$dom("http://www.w3.org/1998/Math/MathML")},configurable:!1,enumerable:!0}}),Object.defineProperties(Window.prototype,{$dom:{get(){return this.document.$dom},configurable:!1,enumerable:!0},$html:{get(){return this.document.$html},configurable:!1,enumerable:!0},$svg:{get(){return this.document.$svg},configurable:!1,enumerable:!0},$mml:{get(){return this.document.$mml},configurable:!1,enumerable:!0}});